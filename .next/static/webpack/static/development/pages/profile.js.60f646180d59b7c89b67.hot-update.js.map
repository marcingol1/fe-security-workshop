{"version":3,"file":"static/webpack/static/development/pages/profile.js.60f646180d59b7c89b67.hot-update.js","sources":["webpack:///./pages/profile.js"],"sourcesContent":["import React from 'react';\nimport Router from 'next/router';\nimport fetch from 'isomorphic-unfetch';\nimport nextCookie from 'next-cookies';\nimport Layout from '../components/layout';\nimport { withAuthSync } from '../utils/auth';\nimport getHost from '../utils/get-host';\n\nconst Profile = props => {\n  const { name, login, bio, avatarUrl } = props.data;\n\n  return (\n    <Layout>\n      <img src={avatarUrl} alt=\"Avatar\" />\n      <h1>{name}</h1>\n      <p className=\"lead\" dangerouslySetInnerHTML={login} />\n      <p>{bio}</p>\n\n      <style jsx>{`\n        img {\n          max-width: 200px;\n          border-radius: 0.5rem;\n        }\n        h1 {\n          margin-bottom: 0;\n        }\n        .lead {\n          margin-top: 0;\n          font-size: 1.5rem;\n          font-weight: 300;\n          color: #666;\n        }\n        p {\n          color: #6a737d;\n        }\n      `}</style>\n    </Layout>\n  );\n};\n\nProfile.getInitialProps = async ctx => {\n  const { token } = nextCookie(ctx);\n  const apiUrl = getHost(ctx.req) + '/api/profile';\n\n  const redirectOnError = () =>\n    typeof window !== 'undefined'\n      ? Router.push('/login')\n      : ctx.res.writeHead(302, { Location: '/login' }).end();\n\n  try {\n    const response = await fetch(apiUrl, {\n      credentials: 'include',\n      headers: {\n        Authorization: JSON.stringify({ token })\n      }\n    });\n\n    if (response.ok) {\n      const js = await response.json();\n      console.log('js', js);\n      return js;\n    } else {\n      // https://github.com/developit/unfetch#caveats\n      return await redirectOnError();\n    }\n  } catch (error) {\n    // Implementation or Network error\n    return redirectOnError();\n  }\n};\n\nexport default withAuthSync(Profile);\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAJA;AAAA;AAAA;AA0BA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AAAA,0GAGA;AAHA;AACA;AALA;AAAA;AAAA;AAWA;AACA;AACA;AAAA;AAAA;AADA;AAFA;AACA;AAXA;AAUA;AACA;AAXA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAkBA;AACA;AAnBA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AA8BA;;;;A","sourceRoot":""}